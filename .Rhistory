macro_madrid_22 <- read.csv2("C:/Users/Pablo/Documents/R/extraccion_madrid_22/macro_madrid_22.csv")
View(macro_madrid_22)
View(macro_madrid_22)
macro_madrid_22 <- read.csv2("C:/Users/Pablo/Documents/R/extraccion_madrid_22/macro_madrid_22.csv")
View(macro_madrid_22)
macro_peninsula_22 <- read.csv2("C:/Users/Pablo/Documents/R/extraccion_madrid_22/macro_peninsula_22.csv")
macro_peninsula_22_sucio <- read.csv2("C:/Users/Pablo/Documents/R/extraccion_madrid_22/macro_peninsula_22.csv")
rm(macro_peninsula_22)
View(macro_peninsula_22_sucio)
View(macro_peninsula_22_sucio)
macro_peninsula_mangueo_22 <- macro_peninsula_22_sucio[, -c(2:9)]
View(macro_madrid_22)
View(macro_peninsula_mangueo_22)
View(macro_peninsula_22_sucio)
install.packages("tidyr")
library(tidyr)
macro_peninsula_mangueo_relleno_22 <- macro_peninsula_mangueo_22 %>%
fill(id, .direction = "down")
View(macro_peninsula_mangueo_relleno_22)
macro_peninsula_mangueo_relleno_22 <- macro_peninsula_mangueo_22 %>%
fill(id, .direction = "down")
View(macro_peninsula_mangueo_relleno_22)
macro_peninsula_mangueo_relleno_22 <- macro_peninsula_mangueo_22 %>%
fill("id", .direction = "down")
View(macro_peninsula_mangueo_relleno_22)
macro_peninsula_mangueo_22$id[data_laguna_mangueo_22$id == ""] <- NA
macro_peninsula_mangueo_22$id[macropeninsula_mangueo_22$id == ""] <- NA
macro_peninsula_mangueo_22$id[macro_peninsula_mangueo_22$id == ""] <- NA
macro_peninsula_mangueo_NA_22 <- datos_peninsula_mangueo_22 %>% fill(id, .direction = "down")
macro_peninsula_mangueo_NA_22 <- macro_peninsula_mangueo_22 %>% fill(id, .direction = "down")
View(macro_peninsula_mangueo_NA_22)
macro_madrid_22 <- read.csv2("C:/Users/Pablo/Documents/R/extraccion_madrid_22/macro_madrid_22.csv")
macro_peninsula_22_sucio <- read.csv2("C:/Users/Pablo/Documents/R/extraccion_madrid_22/macro_peninsula_22.csv")
macro_peninsula_mangueo_22 <- macro_peninsula_22_sucio[, -c(2:9)]
macro_peninsula_mangueo_NA_22$id[macro_peninsula_mangueo_22$id == ""] <- NA
macro_peninsula_mangueo_relleno_22 <- macro_peninsula_mangueo_22 %>% fill(id, .direction = "down")
View(macro_peninsula_mangueo_NA_22)
View(macro_peninsula_mangueo_22)
View(macro_peninsula_mangueo_22)
View(macro_peninsula_mangueo_NA_22)
View(macro_peninsula_mangueo_relleno_22)
View(macro_peninsula_mangueo_relleno_22)
macro_peninsula_mangueo_relleno_22 <- macro_peninsula_mangueo_NA_22 %>% fill(id, .direction = "down")
View(macro_peninsula_mangueo_relleno_22)
install.packages("dplyr")
install.packages("dplyr")
library(dplyr)
macro_peninsula_mangueo_relleno_22 <- macro_peninsula_mangueo_relleno_22 %>%
mutate(across(-1, as.numeric))
macro_peninsula_laguna_22 <- macro_peninsula_mangueo_relleno_22 %>%
group_by(id) %>% #Agrupa todas las filas por el mismo nombre de la laguna.
summarise(across(where(is.numeric), sum, na.rm = TRUE)) # Hace sumatorio de todo lo que es numérico (las especies).
View(macro_peninsula_laguna_22)
View(macro_peninsula_laguna_22)
write.csv(macro_peninsula_laguna_22, "C:/Users/Pablo/Documents/R/extraccion_madrid_22/macro_peninsula_laguna_22.csv", row.names = TRUE)
colnames(macro_peninsula_limpio_22) <- gsub("_22$", "", colnames(macro_peninsula_laguna_22))
colnames(macro_peninsula_laguna_22) <- gsub("_22$", "", colnames(macro_peninsula_limpio_laguna_22))
colnames(macro_peninsula_laguna_22) <- gsub("_22$", "", colnames(macro_peninsula_limpio_22))
colnames(macro_peninsula_laguna_22) <- gsub("_22$", "", colnames(macro_peninsula_laguna_22))
View(macro_peninsula_laguna_22)
View(macro_madrid_22)
macro_madrid <- macro_madrid_22[, -c(2:5)]
macro_madrid <- macro_madrid_22[, -c(2:6)]
macro_madrid_NA$id[macro_madrid$id == ""] <- NA
macro_madridA$id[macro_madrid$id == ""] <- NA
macro_madrid$id[macro_madrid$id == ""] <- NA
View(macro_madrid)
View(macro_madrid)
macro_madrid_NA$Codigo[macro_madrid$Codigo == ""] <- NA
macro_madrid$Codigo[macro_madrid$Codigo == ""] <- NA
View(macro_madrid)
macro_madrid_relleno <- macro_madrid %>% fill(Codigo, .direction = "down")
View(macro_madrid_relleno)
macro_madrid_relleno <- macro_madrid_relleno %>%
mutate(across(-1, as.numeric))
macro_madrid_limpio_22 <- macro_madrid_relleno %>%
group_by(Codigo) %>% #Agrupa todas las filas por el mismo nombre de la laguna.
summarise(across(where(is.numeric), sum, na.rm = TRUE)) # Hace sumatorio de todo lo que es numérico (las especies).
View(macro_madrid_limpio_22)
View(macro_peninsula_laguna_22)
macro_peninsula_limpio <- macro_peninsula_laguna_22
View(macro_peninsula_limpio)
View(macro_peninsula_limpio)
macro_madrid_limpio <- macro_madrid_limpio_22
cols_peninsula <- colnames(macro_peninsula_limpio)[!colnames(macro_peninsula_limpio) %in% c("id")]
cols_madrid <- colnames(macro_madrid_limpio)[!colnames(macro_madrid_limpio) %in% c("Codigo")]
View(macro_madrid_limpio)
comunes <- intersect(cols_peninsula, cols_madrid)
view(comunes)
View(comunes)
comunes
install.packages("stringdist")
library(stringdist)
similares <- stringdist::amatch(cols_madrid, cols_peninsula, maxDist = 2)
similar_pairs <- data.frame(
data_madrid = cols_madrid,
posible_match_peninsula = cols_peninsula[similares]
)
head(similar_pairs)
similares
install.packages("openxlsx")
library(openxlsx)
write.xlsx(similar_pairs, "C:/Users/Pablo/Documents/R/extraccion_madrid_22/especies_similares_M_P_22.xlsx", rowNames = FALSE)
install.packages("dplyr")
install.packages("dplyr")
library(dplyr)
View(macro_madrid_limpio)
View(macro_madrid_limpio_22)
macro_madrid_limpio <- macro_madrid_limpio %>%
rename(Codigo = id)
macro_madrid_limpio <- macro_madrid_limpio %>%
rename(id = Codigo)
View(macro_madrid_limpio)
View(macro_peninsula_limpio)
macro_22 <- bind_rows(macro_madrid_limpio, macro_peninsula_limpio)
View(macro_22)
write.xlsx(macro_22, "C:/Users/Pablo/Documents/R/extraccion_madrid_22/macro_22.xlsx", rowNames = FALSE)
macro_22[is.na(macro_22)] <- 0
View(macro_22)
write.xlsx(macro_22, "C:/Users/Pablo/Documents/R/extraccion_madrid_22/macro_22.xlsx", rowNames = FALSE)
write.xlsx(macro_22, "C:/Users/Pablo/Documents/R/extraccion_madrid_22/macro_22_bruto.xlsx", rowNames = FALSE)
macro_22_limpia <- macro_22[, c("id", which(colSums(macro_22[,-1]) != 0) + 1)]
macro_22_limpia <- macro_22[, c("id", names(macro_22[,-1])[colSums(macro_22[,-1], na.rm = TRUE) != 0])]
View(macro_22_limpia)
write.xlsx(macro_22_limpia, "C:/Users/Pablo/Documents/R/extraccion_madrid_22/macro_22_limpio.xlsx", rowNames = FALSE)
